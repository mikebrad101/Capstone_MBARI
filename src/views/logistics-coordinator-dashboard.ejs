<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logistics Coordinator Dashboard</title>
    <link rel="icon" href="/images/tabLogo.png" type="image/png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
    crossorigin="anonymous">
    <link rel="stylesheet" href="/css/styles.css">
    <style>
   body {
        background-image: url(https://a.travel-assets.com/findyours-php/viewfinder/images/res70/203000/203181-Monterey-Bay-Aquarium.jpg);
        background-size: cover;
        background-position: center;
        position: static;
        height: 750px;
        top: 0;
        left: 0;
        width: 100%;
    }
    </style>
    <script>
    // Use expeditionsNeedingApproval data to generate buttons dynamically
    // Function to create buttons dynamically
    function createButtons() {
        const buttonContainer = document.getElementById('button-container');

        // Iterate through expeditions needing approval
        getExpeditionsNeedingApproval.forEach(expedition => {
            const button = document.createElement('button');
            button.innerText = `Approve Expedition ${expedition.exp_id}`;
            button.addEventListener('click', () => {
                // window.location.href = `/approveExpedition`;
                window.location.href = `/update/:exp_id`

            });

            const span = document.createElement('span');
            span.classList.add('css-1ihz85b-position');
            span.appendChild(button);

            buttonContainer.appendChild(span);
        });
    }


    // Call the function when the page is loaded
    window.onload = createButtons;
    </script>
</head>

<body>
    
    <h1>Welcome to Logistics Coordinator Dashboard</h1>
    <%- include("partials/nav.ejs") %>

    <!-- Add more content and functionalities specific to the MBARI Employee -->
        <div class="search-container">
            <!-- <input type="text" placeholder="Search..."> -->
            <button class="search-button" onclick="window.location.href='/search'"> 
                &#128269;
            </button>
        </div>

    <form>
        <div class="ic-DashboardCard" aria-label="AppCruise" draggable="true" style="opacity: 1;">
            <div class="ic-DashboardCard__header">
                <div class="ic-DashboardCard__header_image" style="background-image: url('https://www.mbari.org/wp-content/uploads/rv-david-packard-featured.jpg');">
                    <div class="ic-DashboardCard__header_hero" aria-hidden="true" style="background-color: rgb(79, 128, 69); opacity: 0;"></div>
                        </div>
                            <div class="ic-DashboardCard__header_content">
                            <h3 class="ic-DashboardCard__header-title ellipsis" title="Approve Expedition">
                            <!--<span style="color: rgb(23,1F,20);">Post Expedition</span>-->
                            </h3>
                            </div>
                        </a>
                        <div>
                            <div id="button-container">
                                    <span data-position="Popover_0" class="css-1ihz85b-position">
        <% approval.forEach(expedition => { %>
            <button type="button" onclick="window.location.href='/update/<%= expedition.expedition_ID %>'">
                Approve Expedition <%= expedition.expedition_ID %>
            </button>
        <% }); %>
                                </span>
                            </div>

                            </div>
                        </div>
                </div>
            </div>
        </div>
    </form>
    <script>
    // Function to show the alert based on expedition status
      const approval = <%= JSON.stringify(approval) %>;

    if (approval.length > 0) {
        alert('There are expeditions with status "Planned" needing approval. Please review and update.');
    }
    </script>

    <footer>
        <div class="foottext">
            <!-- <img src='/images/horizontal-logo-withglow.png' class="footer-logo"> -->
            <p>Website is only for academic purposes. Capstone 2023Â© MBARI</p>
        </div>
    </footer>
</body>
</html>

<!--help with /update/:exp_id 
how to get id for ones that labeled as planned -->
